{"version":3,"sources":["templates/module/index.js"],"names":[],"mappings":"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","file":"templates/module/index.js","sourcesContent":["const fs = require('fs');\nimport path from 'path';\nimport walk from 'walk';\nimport mkdirp from 'mkdirp';\n\nconst sourcePath = path.join(__dirname, 'src');\n\nasync function readAsync(path) {\n  try {\n    return await fs.promise.readFile(path, 'utf8');\n  } catch (error) {\n    if (error.code === 'ENOENT') {\n      return null;\n    }\n    throw error;\n  }\n}\n\nasync function writeAsync(directory, filename, contents) {\n  return new Promise((resolve, reject) => {\n    mkdirp(directory, async (err) => {\n      if (err) return reject(err);\n      let filePath = path.join(directory, filename);\n      await fs.promise.writeFile(filePath, contents, 'utf8');\n      resolve();\n    });\n  });\n}\n\nfunction fixPath(config, path) {\n  let keys = Object.keys(config);\n  keys.forEach((key) => {\n    path = path.replace(`__${key}__`, config[key]);\n  });\n  return path;\n}\n\nexport async function build(config, directory) {\n  \n  let pathConfig = {\n    moduleName: config.moduleName,\n    moduleNameAndroid: config.android.moduleName,\n    moduleNameIOS: config.ios.moduleName\n  };\n  \n  return new Promise((resolve, reject) => {\n    let walker = walk.walk(path.join(__dirname, 'src'), { followLinks: false });\n    \n    walker.on('file', async (basedir, stat, next) => {\n      \n      let template = require(path.join(basedir, stat.name));\n      \n      let relativePath = basedir.replace(sourcePath, '.');\n      let finalPath = path.join(process.cwd(), relativePath);\n      \n      console.log(relativePath);\n      \n      if (relativePath === './android/src/main/java') {\n        finalPath = path.join(finalPath, config.android.packageIdentifier.replace(new RegExp('\\\\.', 'g'), '/'));\n      }\n      \n      let fixedPath = fixPath(pathConfig, finalPath);\n      let fixedFilename = fixPath(pathConfig, stat.name);\n      \n      let lastDotIndex = fixedFilename.lastIndexOf('.');\n      let extension = fixedFilename.slice(lastDotIndex);\n      if (extension === '.js') {\n        fixedFilename = fixedFilename.slice(0, lastDotIndex);\n      }\n\n      await writeAsync(fixedPath, fixedFilename, template(config));\n      next();\n    });\n    \n    walker.on('errors', function errorsHandler(root, nodeStatsArray, next) {\n      nodeStatsArray.forEach(function (n) {\n        console.error(\"[ERROR] \" + n.name)\n        console.error(n.error.message || (n.error.code + \": \" + n.error.path));\n      });\n      next();\n    });\n    \n    walker.on('end', resolve);\n  });\n}"],"sourceRoot":"/source/"}